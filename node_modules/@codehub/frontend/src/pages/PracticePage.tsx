import React, { useState } from 'react';
import Editor from '@monaco-editor/react';

const PracticePage = () => {
  const [code, setCode] = useState('// Write your code here\nconsole.log("Hello World!");');
  const [output, setOutput] = useState('');

  const handleRun = () => {
    // Simple mock execution via eval (safe only for local demo/sandbox)
    // In production, send to backend sandbox
    try {
      const logs: string[] = [];
      const originalLog = console.log;
      console.log = (...args) => logs.push(args.join(' '));

      // eslint-disable-next-line
      new Function(code)();

      console.log = originalLog;
      setOutput(logs.join('\n') || 'Code ran successfully (no output)');
    } catch (err: any) {
      setOutput(`Error: ${err.message}`);
    }
  };

  return (
    <div className="flex flex-col h-[calc(100vh-64px)]">
      <div className="bg-gray-800 text-white p-4 flex justify-between items-center">
        <h2 className="text-xl font-bold">Practice Arena</h2>
        <button
          onClick={handleRun}
          className="bg-green-600 hover:bg-green-700 px-4 py-2 rounded font-bold"
        >
          Run Code
        </button>
      </div>
      <div className="flex-1 flex">
        <div className="w-1/2 border-r border-gray-700">
          <Editor
            height="100%"
            defaultLanguage="javascript"
            theme="vs-dark"
            value={code}
            onChange={(val) => setCode(val || '')}
            options={{
              minimap: { enabled: false },
              fontSize: 14,
            }}
          />
        </div>
        <div className="w-1/2 bg-gray-900 text-gray-300 p-4 font-mono whitespace-pre-wrap overflow-auto">
          <div className="text-sm font-semibold text-gray-500 mb-2">OUTPUT</div>
          {output}
        </div>
      </div>
    </div>
  );
};

export default PracticePage;
